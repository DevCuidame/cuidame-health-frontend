<div class="contacts-container">
    <h2>Contactos de Emergencia</h2>
    <p class="description">Registra hasta 3 contactos de emergencia para que puedan ser notificados en caso necesario.</p>
  
    <div *ngIf="isLoading" class="loader">
      <ion-spinner name="circular"></ion-spinner>
      <p>Cargando contactos...</p>
    </div>
  
    <div *ngIf="!isLoading" class="contacts-form">
      <form [formGroup]="contactsForm" (ngSubmit)="saveContacts()">
        <!-- Contacto 1 -->
        <div class="contact-card">
          <div class="contact-header">
            <h3>Contacto Principal</h3>
            <ion-icon 
              *ngIf="hasContact(1)"
              name="trash-outline" 
              class="delete-icon" 
              (click)="deleteContact(1)">
            </ion-icon>
          </div>
          <div class="contact-fields">
            <div class="form-group">
              <label for="nombre1">Nombre completo</label>
              <input type="text" id="nombre1" formControlName="nombre1" placeholder="Nombre del contacto">
              <small *ngIf="formErrors.nombre1" class="error-message">{{formErrors.nombre1}}</small>
            </div>
            <div class="form-group">
              <label for="telefono1">Teléfono</label>
              <input type="tel" id="telefono1" formControlName="telefono1" placeholder="Número de teléfono">
              <small *ngIf="formErrors.telefono1" class="error-message">{{formErrors.telefono1}}</small>
            </div>
          </div>
        </div>
        
        <!-- Contacto 2 -->
        <div class="contact-card">
          <div class="contact-header">
            <h3>Contacto Secundario</h3>
            <ion-icon 
              *ngIf="hasContact(2)"
              name="trash-outline" 
              class="delete-icon" 
              (click)="deleteContact(2)">
            </ion-icon>
          </div>
          <div class="contact-fields">
            <div class="form-group">
              <label for="nombre2">Nombre completo</label>
              <input type="text" id="nombre2" formControlName="nombre2" placeholder="Nombre del contacto">
              <small *ngIf="formErrors.nombre2" class="error-message">{{formErrors.nombre2}}</small>
            </div>
            <div class="form-group">
              <label for="telefono2">Teléfono</label>
              <input type="tel" id="telefono2" formControlName="telefono2" placeholder="Número de teléfono">
              <small *ngIf="formErrors.telefono2" class="error-message">{{formErrors.telefono2}}</small>
            </div>
          </div>
        </div>
        
        <!-- Contacto 3 -->
        <div class="contact-card">
          <div class="contact-header">
            <h3>Contacto Adicional</h3>
            <ion-icon 
              *ngIf="hasContact(3)"
              name="trash-outline" 
              class="delete-icon" 
              (click)="deleteContact(3)">
            </ion-icon>
          </div>
          <div class="contact-fields">
            <div class="form-group">
              <label for="nombre3">Nombre completo</label>
              <input type="text" id="nombre3" formControlName="nombre3" placeholder="Nombre del contacto">
              <small *ngIf="formErrors.nombre3" class="error-message">{{formErrors.nombre3}}</small>
            </div>
            <div class="form-group">
              <label for="telefono3">Teléfono</label>
              <input type="tel" id="telefono3" formControlName="telefono3" placeholder="Número de teléfono">
              <small *ngIf="formErrors.telefono3" class="error-message">{{formErrors.telefono3}}</small>
            </div>
          </div>
        </div>
  
        <div class="contact-validation-error" *ngIf="formErrors.general">
          <ion-icon name="alert-circle-outline"></ion-icon>
          <span>{{formErrors.general}}</span>
        </div>
  
        <div class="buttons-container">
          <button type="submit" [disabled]="isSaving || !isFormValid()" class="save-button">
            <span *ngIf="!isSaving">Guardar Contactos</span>
            <ion-spinner *ngIf="isSaving" name="circular" class="spinner-button"></ion-spinner>
          </button>
        </div>
      </form>
    </div>
  </div>